{"version":3,"sources":["../index.js"],"names":["options","hook","computeProperties","item","Promise","all","Object","keys","map","property","$fetch","propertyOptions","call","app","e","console","error","computeResults","items","Array","isArray","data","result"],"mappings":";;;;;;kBAAe,UAAUA,OAAV,EAAmB;AAChC;AAAA,iCAAO,WAAgBC,IAAhB,EAAsB;AAC3B,YAAMC;AAAA,sCAAoB,WAAOC,IAAP,EAAaH,OAAb,EAAyB;AACjD,gBAAMI,QAAQC,GAAR,CAAYC,OAAOC,IAAP,CAAYP,OAAZ,EAAqBQ,GAArB;AAAA,0CAAyB,WAAMC,QAAN,EAAkB;AAAA,sCACpBT,QAAQS,QAAR,CADoB;;AAAA,oBACnDC,MADmD,qBACnDA,MADmD;AAAA,oBACxCC,eADwC;;AAG3D,kBAAI;AACFR,qBAAKM,QAAL,IAAiB,MAAMC,OAAOE,IAAP,CAAYT,IAAZ,EAAkBF,KAAKY,GAAvB,CAAvB;AACD,eAFD,CAEE,OAAOC,CAAP,EAAU;AACVX,qBAAKM,QAAL,IAAiB,IAAjB;AACAM,wBAAQC,KAAR,CAAcF,CAAd;AACA;AACD;;AAED,oBAAMG,eAAed,KAAKM,QAAL,CAAf,EAA+BE,eAA/B,CAAN;AACD,aAZiB;;AAAA;AAAA;AAAA;AAAA,eAAZ,CAAN;AAaD,SAdK;;AAAA;AAAA;AAAA;AAAA,UAAN;;AAgBA,YAAMM,iBAAiB,SAAjBA,cAAiB,CAACd,IAAD,EAAOH,OAAP,EAAmB;AACxC,cAAMkB,QAAQC,MAAMC,OAAN,CAAcjB,KAAKkB,IAAnB,IAA2BlB,KAAKkB,IAAhC,GAAwCF,MAAMC,OAAN,CAAcjB,IAAd,IAAsBA,IAAtB,GAA6B,CAACA,IAAD,CAAnF;;AAEA,eAAOC,QAAQC,GAAR,CAAYa,MAAMV,GAAN,CAAU;AAAA,iBAAQN,kBAAkBC,IAAlB,EAAwBH,OAAxB,CAAR;AAAA,SAAV,CAAZ,CAAP;AACD,OAJD;;AAMA,YAAMiB,eAAehB,KAAKqB,MAApB,EAA4BtB,OAA5B,CAAN;;AAEA,aAAOC,IAAP;AACD,KA1BD;;AAAA;AAAA;AAAA;AAAA;AA2BD,C","file":"index.js","sourcesContent":["export default function (options) {\n  return async function (hook) {\n    const computeProperties = async (item, options) => {\n      await Promise.all(Object.keys(options).map(async property => {\n        const { $fetch, ...propertyOptions } = options[property]\n\n        try {\n          item[property] = await $fetch.call(item, hook.app)\n        } catch (e) {\n          item[property] = null\n          console.error(e)\n          return\n        }\n\n        await computeResults(item[property], propertyOptions)\n      }))\n    }\n\n    const computeResults = (item, options) => {\n      const items = Array.isArray(item.data) ? item.data : (Array.isArray(item) ? item : [item])\n\n      return Promise.all(items.map(item => computeProperties(item, options)))\n    }\n\n    await computeResults(hook.result, options)\n\n    return hook\n  }\n}\n"]}